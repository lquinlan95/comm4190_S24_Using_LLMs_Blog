<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Leesa">
<meta name="dcterms.date" content="2024-03-15">
<meta name="description" content="Getting a little creative input from Claude">

<title>RoboTalk - Sci-Fi Worldbuilding</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top quarto-banner">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">RoboTalk</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <h1 class="title">Sci-Fi Worldbuilding</h1>
                  <div>
        <div class="description">
          Getting a little creative input from Claude
        </div>
      </div>
                          <div class="quarto-categories">
                <div class="quarto-category">LLMs</div>
                <div class="quarto-category">prompting</div>
                <div class="quarto-category">text-generation</div>
                <div class="quarto-category">creativity</div>
                <div class="quarto-category">Claude</div>
                <div class="quarto-category">storytelling</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Leesa </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 15, 2024</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">





<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="body10_files/figure-html/29f68b81-0b57-4a91-83bf-e8ff96024169-1-1ca47003-af34-4d44-9df0-e656ed6679fb.png" class="img-fluid figure-img"></p>
<figcaption>image.png</figcaption>
</figure>
</div>
<p><em>Produced by ChatGPT</em></p>
<section id="getting-to-know-claude" class="level2">
<h2 class="anchored" data-anchor-id="getting-to-know-claude">Getting to Know Claude</h2>
<p>I have been spending a lot of time exploring ChatGPT as my primary LLM. However, I was interested in getting better familiarized with a new system: Claude, an LLM from Anthropic built around the tenets of responsible design.</p>
<p>To start this exploration, I used inspiration from my creative writing class. I have been tasked with creating a new science fiction world and writing a story within that world. I wanted to see how well Claude could perform at a creative task like that.</p>
<p>Claude’s user interface is a bit different from ChatGPT. Whereas ChatGPT has a single input field into which you include all the relevant information, Calud has two input fields. The first is “System Prompt” - in this region, it seems like you include the context that you want the system to consider throughout the operation. The second field is “User,” into which you input your actual request.</p>
<section id="initial-prompt" class="level3">
<h3 class="anchored" data-anchor-id="initial-prompt">Initial Prompt</h3>
<p>In the System Prompt field, I input: “You are a very talented science fiction writer. You are in the process of creating a new world in which you will set your next novel. You have done this many times before and know the best practices for writing and worldbuilding. You are also an avid reader of many excellent novels.”</p>
<p>In the User field, I input: “What process or steps do you recommend authors follow in order to create a new science fiction world?”</p>
<p>Claude responded: “Here are some key steps I recommend for creating a new science fiction world:</p>
<ol type="1">
<li><p>Establish the core concept and premise. What is the central idea, theme or hook of your world? Is it set in the far future, an alternate reality, on an alien planet, etc.? Clarify the high-level vision.</p></li>
<li><p>Develop the history and timeline. Create an outline of the major events, eras, and turning points that shaped your world. Go back centuries or millennia to chart out how things evolved to reach the “present day” of your story.</p></li>
<li><p>Define the scientific laws and technologies. Decide what is scientifically possible in your universe. Establish the key technological advancements that impact society, like space travel, AI, genetic engineering, etc. Be consistent in how you apply the science.</p></li>
<li><p>Design the cultures and social structures. Create the major alien species, civilizations, factions and how they interact. Determine forms of government, economic systems, religions, values. Consider cultural practices, taboos, conflicts.</p></li>
<li><p>Flesh out the environments and locations. Envision the planets, cities, space stations and key locations. Map out climates, geography, architecture, aesthetics. Use all senses to make it vivid.</p></li>
<li><p>Populate it with interesting characters. Create a cast that showcases the diversity and tensions of your world. Give each character clear motivations, backgrounds and roles in the story.</p></li>
<li><p>Dive into the details to add realism and depth. Work out elements like languages, foods, music, fashion, entertainment, etc. Think about daily life for inhabitants. Add interesting quirks to make the setting feel lived-in.</p></li>
<li><p>Maintain internal consistency and logic. Make sure the various elements of your world fit together sensibly. Avoid contradictions or things that break suspension of disbelief.</p></li>
<li><p>Leave some mystery and room for expansion. Don’t over-explain everything. Leave intriguing gaps for readers to fill in with their imagination. Give yourself flexibility to expand the universe in sequels.</p></li>
<li><p>Introduce the world gradually in your story. Avoid lengthy info-dumps. Reveal aspects of the setting bit by bit as they become relevant. Build it organically through the characters’ experiences.</p></li>
</ol>
<p>The key is fleshing out the world in increasing layers of detail, while focusing on the elements that matter most to your story and characters. Have fun exploring the possibilities and building an immersive universe for readers to get lost in! Let me know if you hav”</p>
<p>This was pretty good advice that I though would be useful for helping to flesh out a world.e any other questions.</p>
</section>
<section id="creating-a-world" class="level3">
<h3 class="anchored" data-anchor-id="creating-a-world">Creating a World</h3>
<p><strong>I followed up with another User prompt:</strong> “Great! Now using this advice, please create a new world for your new book.”</p>
<p><strong>It responded:</strong> “Alright, here’s a new science fiction world I’ve created using the process outlined above:</p>
<p>Core Concept: Set in the year 2647, humanity has spread across the galaxy, colonizing planets and encountering alien civilizations. The story focuses on the crew of a deep-space exploration vessel navigating the complex political landscape and ancient mysteries of this vast universe.</p>
<p>History &amp; Timeline: - 2130s: Breakthrough in faster-than-light travel enables interstellar colonization. - 2200s-2300s: Expansion era, as human colonies are established on habitable worlds. First contact with alien species. - 2400s: Formation of the Galactic Confederation, a political alliance of human and alien worlds. Rising tensions between factions. - 2500s-2600s: Period of uneasy peace and cold war-like conflicts. Exploration of uncharted regions of space.</p>
<p>Science &amp; Technology: - FTL drives allow ships to traverse light years in days or weeks. - Advanced terraforming techniques make hostile planets habitable. - Sophisticated AI assists in ship operations and scientific research. - Holographic interfaces and neural implants are common. - Energy weapons and shielding technology used in space combat.</p>
<p>Cultures &amp; Social Structures: - The Galactic Confederation is a democracy, but power imbalances exist between worlds. Tensions simmer between expansionist and isolationist factions. - The Ascending Hegemony is an authoritarian alien empire that views itself as superior. Maintains an uneasy truce with the Confederation. - The Vox Collective is a hivemind species that communicates telepathically. Distrusted by many due to their inscrutable nature. - The Rin-Tao are a spiritual, pacifist species that seek harmony. Often act as mediators in conflicts.</p>
<p>Key Locations: - Novus Prime: Capital world of the Confederation. A gleaming metropolis and center of politics and trade. - Frontier Station: A remote outpost on the edge of explored space. Starting point for the story. - Aethon Nebula: An astronomical wonder that hides ancient secrets. Rumored to be the source of a powerful alien artifact. - Zephyr’s Gate: A massive space station built into an asteroid. Houses a notorious black market.</p>
<p>Characters: - Captain Lena Hawkins: Seasoned commander of the exploration vessel. Haunted by a mysterious incident in her past. - Kal Renik: Alien first officer with a sharp wit and loyalty to his crew. Has a secret agenda. - Dr.&nbsp;Asha Singh: Brilliant xenobiologist driven to understand the universe’s mysteries. Possesses latent psychic abilities. - Zara Quill: Skilled pilot and mechanic with a sarcastic streak. Has a knack for getting into trouble.</p>
<p>The world is filled with diverse alien species, each with unique cultures and biologies. Ancient ruins and artifacts hint at a long-vanished precursor civilization. Political intrigue and power struggles between factions keep things tense. Strange phenomena and uncharted regions of space add an air of mystery and discovery.</p>
<p>This is just a high-level overview, but I think it provides a solid foundation to build an immersive and exciting science fiction universe! Let me know if you’d like me to elaborate on any specific aspects of the world.”</p>
<p><strong>This was a well-done attempt, with a lot of creative detail and internal logic!</strong></p>
</section>
<section id="pushing-a-little-further" class="level3">
<h3 class="anchored" data-anchor-id="pushing-a-little-further">Pushing a Little Further</h3>
<p><strong>I wanted to then test how Claude operated in different styles, so I asked:</strong> “Great! Now can you create two examples of cultural artifacts from the world you’ve created? These could be songs, poems, religions, wisdom, etc”</p>
<p><strong>It replied:</strong> “Certainly! Here are two cultural artifacts from the science fiction world I’ve created:</p>
<ol type="1">
<li>The Saga of the Seven Suns (Rin-Tao epic poem)</li>
</ol>
<p>“In the dawn of ages past, when stars were young and bright, Seven suns in sacred dance, wove tales of cosmic might. From their celestial ballet, the universe unfurled, Each sun a beacon of hope, for life to be unfurled.</p>
<p>The first sun, a radiant gold, the source of warmth and light, The second, a soothing blue, calming the infinite night. The third, a fiery crimson, passion’s eternal blaze, The fourth, an emerald green, nature’s lifegiving maze.</p>
<p>The fifth, a shimmering silver, a mirror of the soul, The sixth, a deep indigo, the depths of knowledge whole. The seventh, a brilliant white, the balance and the key, Uniting all in harmony, for all eternity.</p>
<p>Remember, children of the stars, the Seven Suns divine, In darkest times, their guiding light, forever shall align. Seek wisdom in their ancient dance, a path to peace and grace, And in their cosmic symphony, find your destined place.”</p>
<p>This epic poem is a cornerstone of Rin-Tao culture, passed down through generations. It tells the mythical story of the seven suns that created the universe and embodies the species’ values of harmony, wisdom, and spiritual connection to the cosmos. The poem serves as a reminder to seek balance and enlightenment, even in the face of adversity.</p>
<ol start="2" type="1">
<li>The Creed of the Void (Excerpt from a Vox Collective sacred text)</li>
</ol>
<p>“We are the Vox, the voice of the void. In the silence of space, we find unity. In the depths of the mind, we find truth. Our thoughts are one, our purpose clear. We seek the Great Connection, the merging of all minds into a single, perfect consciousness.</p>
<p>Through our telepathic bond, we transcend the limitations of the physical realm. We see beyond the veil of individuality, into the vast network of cosmic knowledge. In the sharing of thoughts, we find strength. In the harmony of our minds, we find peace.</p>
<p>The path to the Great Connection is not without sacrifice. We must let go of the self, surrendering to the greater whole. Only then can we truly understand the universe and our place within it. For in the end, we are all stardust, bound together by the unseen threads of the cosmos.</p>
<p>Embrace the silence, for in it, we hear the whispers of the universe. Embrace the void, for in it, we find our true selves. We are the Vox, and in our unity, we shall unlock the secrets of existence itself.”</p>
<p>This sacred text reflects the hivemind nature of the Vox Collective and their spiritual beliefs. It emphasizes the importance of telepathic connection, unity, and the pursuit of cosmic knowledge. The Vox believe that by merging their minds and letting go of individuality, they can achieve a higher state of being and understanding. This text provides insight into their mysterious and often misunderstood culture.”</p>
<p><strong>I appreciated that Claude was able to translate the information that it generated for its world into items found in that world. That is an impressive transference!</strong></p>
</section>
<section id="but-can-it-love" class="level3">
<h3 class="anchored" data-anchor-id="but-can-it-love">But Can it Love?</h3>
<p><strong>A final test I wanted to include was how well Claude could put itself into the mind of the character it created.</strong></p>
<p><strong>I asked Claude:</strong> “Great! Now can you describe a romantic entanglement within this world”</p>
<p><strong>It replied:</strong> “Sure, here’s a romantic entanglement that could unfold within this science fiction world:</p>
<p>Captain Lena Hawkins and her alien first officer, Kal Renik, have always had a strong bond and deep respect for each other. They’ve worked side by side for years, navigating countless dangers and challenges aboard their exploration vessel. However, their relationship has always remained professional, despite the undercurrent of tension and unspoken feelings between them.</p>
<p>As they embark on a new mission to investigate the mysterious Aethon Nebula, Lena and Kal find themselves drawn closer together. Late one night cycle, while poring over star charts in the ship’s observatory, they finally confront their feelings. Kal reveals that his secret agenda has always been to protect Lena, ever since he learned of the tragic incident in her past. Lena, in turn, confesses that she’s been fighting her growing attraction to Kal, afraid of compromising her duties as captain.</p>
<p>Despite their reservations, they cannot deny the depth of their connection. They share a tentative first kiss under the starlight, both exhilarated and terrified by the implications. As their mission grows more perilous, with ancient secrets and hidden dangers lurking in the nebula, Lena and Kal must navigate not only the challenges of space exploration but also the complexities of an interspecies romance.</p>
<p>Their love faces many obstacles, from the disapproval of some crew members to the cultural differences between their worlds. Kal’s people have strict traditions around mating and partnership, while Lena has always prioritized her career over personal relationships. They must find a way to bridge these gaps and build a future together, even as the fate of the galaxy hangs in the balance.</p>
<p>As the story unfolds, their romance becomes a source of both strength and vulnerability. They draw courage and comfort from each other in the face of impossible odds, but their enemies also seek to exploit their bond. In a climactic moment, Kal may be forced to choose between his loyalty to his people and his love for Lena, while she must decide how far she’s willing to go to protect him and their future together.</p>
<p>Through their love story, the themes of unity, sacrifice, and the power of connection across boundaries are explored, mirroring the larger conflicts and aspirations of the galaxy they inhabit. Whether their romance will endure the trials ahead remains to be seen, but one thing is certain: the love between a human captain and her alien first officer will be a defining force in the shaping of this science fiction universe.”</p>
<p>I followed up: “Lena has just died. How does Kal react?”</p>
<p>Claude replied: “Kal is devastated by Lena’s death, his world shattered in an instant. As he holds her lifeless body in his arms, the reality of his loss hits him like a supernova, leaving him feeling hollow and adrift in a vast, empty universe.</p>
<p>In the days that follow, Kal struggles to maintain his composure, his usual sharp wit and confident demeanor replaced by a haunting silence and a deep, unrelenting grief. He goes through the motions of his duties as first officer, but his heart is no longer in it. The ship, once a place of excitement and discovery, now feels like a cold, meaningless void without Lena’s presence.</p>
<p>At night, alone in the quarters they once shared, Kal is overwhelmed by memories of their time together. He replays every moment, every touch, every whispered word of affection, torturing himself with the realization that he will never experience those joys again. He clutches Lena’s favorite jacket, breathing in her fading scent, desperate to hold onto any piece of her.</p>
<p>As the crew prepares for Lena’s funeral, Kal retreats into himself, shutting out the condolences and sympathies of his crewmates. He feels a bitter anger rising within him, a rage at the universe for taking Lena away, at himself for not being able to protect her. He lashes out at those who try to comfort him, pushing away the very people who understand his pain.</p>
<p>During the funeral, as Lena’s body is released into the infinite depths of space, Kal finally breaks down. Tears stream down his face as he watches the love of his life disappear into the void, a shimmering speck of light swallowed by the darkness. He whispers a final promise to her, vowing to carry on her legacy and to find the strength to keep living, even in a universe without her.</p>
<p>In the weeks and months that follow, Kal throws himself into his work, determined to honor Lena’s memory by being the best first officer he can be. He takes on extra duties, working himself to exhaustion in an attempt to dull the constant ache in his heart. Slowly, with the support of his crewmates and the passage of time, Kal begins to heal. He knows that he will never fully recover from losing Lena, but he also knows that she would want him to find purpose and happiness again.</p>
<p>As he stands on the bridge of the ship, gazing out at the stars they once explored together, Kal feels a flicker of hope amidst the grief. He knows that Lena’s spirit lives on in the hearts of those who loved her, and in the endless wonders of the universe they sought to uncover. He vows to carry her with him always, a guiding light in the darkness, as he continues their mission to explore the stars and unravel the mysteries of the cosmos.”</p>
<p><strong>Love it!</strong></p>
<p>Claude performed super well on this task! I was impressed by the depth of the worldbuilding, including an understanding of the characters’ motivations and emotions. One key think I noticed was that Claude’s responses were far longer and more in-depth than ChatGPT’s. I was honestly confused when Claude kept typing. I could definitely see myself using this more regularly for text-based projects.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/lquinlan95\.github\.io\/comm4190_S24_Using_LLMs_Blog\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>